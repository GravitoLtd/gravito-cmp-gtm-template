___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.

___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Gravito CMP",
  "categories": [
    "ADVERTISING",
    "TAG_MANAGEMENT"
  ],
  "brand": {
    "id": "github.com_GravitoLtd",
    "displayName": "gravito-ltd-cmp-template",
    "thumbnail": "data:image/png;base64,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"
  },
  "description": "Add gravito cmp to your website, to get user consents and utilize gravito's excellent capabilities.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "gravitoconfigtoken",
    "displayName": "Configuration token generated from Gravito portal.",
    "simpleValueType": true
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Enter your template code here.
const log = require('logToConsole');
const setInWindow = require('setInWindow');
const copyFromWindow = require('copyFromWindow');
const callInWindow = require('callInWindow');
const injectScript = require('injectScript');
const queryPermission = require('queryPermission');
const configPath = data.gravitoConfigUrl;
const setDefaultConsentState = require('setDefaultConsentState');
const updateConsentState = require('updateConsentState');
const callLater = require('callLater');
const getTimestamp = require('getTimestamp');
const createQueue = require('createQueue');
const JSON = require('JSON');
const makeString = require('makeString');
const fromBase64 = require('fromBase64');

const CONSENT = {
    denied: 'denied',
    granted: 'granted'
};


setInWindow("gravitoconfigtoken", data.gravitoconfigtoken, false);

// function to return consent levels based on user preferences.
function getConsentLevel(consents, consentId){
  var item = consents.filter(item => item.id === consentId);
  return item.length>0?item[0].consent:false;
}


// listener function
const gravitoCurrentState = (currentState) => {

 
    // get consent levels based on setup in config.
    var adConsent = getConsentLevel(currentState.consentState, currentState.config.core.adsConsentId?currentState.config.core.adsConsentId:0);

    var analyticsConsent = getConsentLevel(currentState.consentState, currentState.config.core.analyticsConsentId?currentState.config.core.analyticsConsentId:0);
    var functionalityConsent = getConsentLevel(currentState.consentState, currentState.config.core.functionalityConsentId?currentState.config.core.functionalityConsentId:0);
    var personalizationConsent = getConsentLevel(currentState.consentState, currentState.config.core.personalizationConsentId?currentState.config.core.personalizationConsentId:0);
    var securityConsent = getConsentLevel(currentState.consentState, currentState.config.core.securityConsentId?currentState.config.core.securityConsentId:0);
    var adUserDataConsent = getConsentLevel(currentState.consentState, currentState.config.core.adsUserDataConsentId?currentState.config.core.adsUserDataConsentId:0);
    var adPersonalizationConsent = getConsentLevel(currentState.consentState, currentState.config.core.adsPersonalizationConsentId?currentState.config.core.adsPersonalizationConsentId:0);
    const updateData = {
    ad_storage: adConsent ? CONSENT.granted : CONSENT.denied,
    analytics_storage: analyticsConsent ? CONSENT.granted : CONSENT.denied,
    ad_user_data: adUserDataConsent ? CONSENT.granted : CONSENT.denied,
    ad_personalization: adPersonalizationConsent ? CONSENT.granted : CONSENT.denied,
    functionality_storage: functionalityConsent ? CONSENT.granted : CONSENT.denied,
    personalization_storage: personalizationConsent? CONSENT.granted :       CONSENT.denied,
    security_storage: securityConsent  ? CONSENT.granted : CONSENT.denied
    
    };
    
    // send updated consents.
    updateConsentState(updateData);
    
    // add consents event into data layer.
    const dataLayerPush = createQueue('dataLayer');
    dataLayerPush({'event': 'grvupdate', 'consents': currentState.consentState});
};

const onSuccess = () => {
  // add event listener.
  callInWindow('gravitoAddEventListner', gravitoCurrentState);
  data.gtmOnSuccess();
};
 

let scriptUrl = 'https://cdn.gravito.net/customhtmlscripts/cmpTemplateWrapper.js';


if (queryPermission('inject_script', scriptUrl)) 
{ 
   // set default consents.
  setDefaultConsentState({
    'ad_storage': CONSENT.denied,
    'analytics_storage': CONSENT.denied,
    'ad_user_data': CONSENT.denied,
    'ad_personalization': CONSENT.denied,
    'functionality_storage': CONSENT.denied,
    'personalization_storage':  CONSENT.denied,
    'security_storage':CONSENT.denied,
    'wait_for_update': 500
  });
 // inject gravito script.
 injectScript(scriptUrl, onSuccess, data.gtmOnFailure);
} 
else 
{
 data.gtmOnFailure();
}

// Call data.gtmOnSuccess when the tag is finished.
data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gravitoconfigtoken"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gravitoAddEventListner"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "dataLayer"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://cdn.gravito.net/customhtmlscripts/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_consent",
        "versionId": "1"
      },
      "param": [
        {
          "key": "consentTypes",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "analytics_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "functionality_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "personalization_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "security_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "wait_for_update"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_user_data"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_personalization"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Quick Test
  code: runCode();
setup: ''


___NOTES___

Created on 09/08/2023, 13:16:42


